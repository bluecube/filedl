{% extends "base.html" %}
{% block title %}{{ directory_path }}{% endblock %}
{% block content %}
<nav>
    {% if !app_name.is_empty() %}<div class="app_name">{{ app_name }}</div>{% endif %}
    <h1 class="breadcrumbs"><a class="home" href="{{ download_base_url }}">home</a>{% for piece in directory_breadcrumbs %}/<a href="{{ download_base_url }}/{{ piece.link_url }}">{{ piece.name }}</a>{% endfor %}</h1>
</nav>
<section id="content">
    {% if items.is_empty() %}
    <div class="empty-dir-listing">No data</div>
    {% else %}
    <ul class="dir-listing">
        {% for item in items %}
        <li class="{{ item.item_type }}">
            <a class="main-link" href="{% call url(item) %}">
                {%- if item.item_type.is_thumbnailable() -%}
                    <img class="thumbnail" src="{% call thumb_url(item, 64) %}" loading="lazy" />
                {%- endif -%}
                <span class="underlined">{{ item.name }}{% if item.item_type.is_directory() %}/{% endif %}</span>
            </a>
            <div class="details">
                {% if !item.item_type.is_directory() %}<span class="size">{{ item.file_size|filesizeformat }}</span>{% endif %}
                {{ item.modified|time_format(display_timezone)|safe }}
            </div>
        </li>
        {% endfor %}
    </ul>
    {% endif %}
</section>
{% endblock %}
{% macro url(item) %}{{ download_base_url }}/{% if !directory_path.is_empty() %}{{ directory_path }}/{% endif %}{{ item.name }}{% endmacro %}
{% macro thumb_url(item, size) %}{% call url(item) %}?mode=thumb{{ size }}{% match item.source_hash %}{% when Some with (h) %}&cache_hash={{ h }}{% when None %}{% endmatch %}{% endmacro %}
